<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="utf-8" /&gt;</p>
<p class="p1">&lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;</p>
<p class="p1">&lt;title&gt;Secret Santa – Anonymous Sender&lt;/title&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>:root { --bg:#0e1116; --card:#151a22; --ink:#e8eef6; --muted:#9fb0c3; --accent:#2aa7ff; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>*{box-sizing:border-box}</p>
<p class="p1"><span class="Apple-converted-space">  </span>body{margin:0;background:#0e1116;color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}</p>
<p class="p1"><span class="Apple-converted-space">  </span>header{padding:24px 16px;text-align:center}</p>
<p class="p1"><span class="Apple-converted-space">  </span>header h1{margin:0 0 6px;font-size:clamp(22px,3.6vw,30px)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>main{max-width:980px;margin:0 auto 60px;padding:0 16px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.card{background:var(--card);border:1px solid #222a36;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.25)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.toolbar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid #202735}</p>
<p class="p1"><span class="Apple-converted-space">  </span>button{cursor:pointer;border:1px solid #2a3343;background:#1b2230;color:var(--ink);padding:10px 14px;border-radius:10px;font-weight:700}</p>
<p class="p1"><span class="Apple-converted-space">  </span>button.primary{background:linear-gradient(180deg,#2b7cff,#2aa7ff);border-color:#2aa7ff;color:#071422}</p>
<p class="p1"><span class="Apple-converted-space">  </span>button.danger{background:#3a1f25;border-color:#5e2b35}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.ghost{background:transparent}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.muted{color:var(--muted);font-size:13px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.table-wrap{overflow:auto}</p>
<p class="p1"><span class="Apple-converted-space">  </span>table{width:100%;border-collapse:collapse}</p>
<p class="p1"><span class="Apple-converted-space">  </span>th,td{padding:10px 8px;border-bottom:1px solid #222a36;text-align:left;font-size:14px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>th{position:sticky;top:0;background:#131925;z-index:1}</p>
<p class="p1"><span class="Apple-converted-space">  </span>input[type="text"],input[type="email"]{width:100%;padding:9px 10px;border:1px solid #293140;border-radius:8px;background:#0e141e;color:var(--ink)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>input::placeholder{color:#7687a0}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.status{padding:12px 16px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.pill{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid #223047;background:#101725;color:#9fc6ff;font-size:12px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.ok{color:#7dffb6;border-color:#1e3a2c}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.err{color:#ff8b8b;border-color:#5c2d2d}</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1">&lt;header&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;h1&gt;Secret Santa – Anonymous Sender&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;p class="muted"&gt;Enter people below. Emails are sent server-side; you won’t see who got who.&lt;/p&gt;</p>
<p class="p1">&lt;/header&gt;</p>
<p class="p1">&lt;main&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;section class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="toolbar"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="addRow"&gt;+ Add person&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="sample" class="ghost"&gt;Fill sample&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="clear" class="danger"&gt;Clear&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="send" class="primary"&gt;🎁 Send assignments&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="status"&gt;&lt;span id="pill" class="pill"&gt;Ready&lt;/span&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="table-wrap"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;table&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th style="min-width:160px"&gt;Name *&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th style="min-width:240px"&gt;Email *&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th style="min-width:160px"&gt;Group (optional)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th style="min-width:260px"&gt;Exclude (names, comma-sep)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th style="width:60px"&gt;Remove&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;tbody id="body"&gt;&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="toolbar"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;label class="muted"&gt;Organizer receipt (optional): &lt;input id="orgEmail" type="email" placeholder="you@domain.com" style="margin-left:8px"&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;label class="muted"&gt;Email subject: &lt;input id="emailSubject" type="text" placeholder="Your Secret Santa assignment 🎁" style="margin-left:8px;min-width:260px"&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="save" class="ghost"&gt;Save list (browser)&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="load" class="ghost"&gt;Load&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="status muted" style="padding-top:0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;p&gt;Rules enforced: no self-picks, no same-group picks, per-person excludes, unique names &amp; unique emails, and a one-to-one perfect matching (no duplicates, no orphans).&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/section&gt;</p>
<p class="p1">&lt;/main&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbxem4uOVXSVhVUnhzvl5wVZC3biw6ptixZOL-EF7EUzF4G-_BsvAQwPj-emIyfedLms/exec';</p>
<p class="p2"><br></p>
<p class="p1">const tbody = document.getElementById('body');</p>
<p class="p1">const pill = document.getElementById('pill');</p>
<p class="p2"><br></p>
<p class="p1">function rowTemplate(p={name:'',email:'',group:'',exclude:''}){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const tr = document.createElement('tr');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const c = (html) =&gt; { const td=document.createElement('td'); td.innerHTML=html; return td; };</p>
<p class="p1"><span class="Apple-converted-space">  </span>tr.appendChild(c(`&lt;input type="text" placeholder="e.g. Alex" value="${esc(p.name)}"&gt;`));</p>
<p class="p1"><span class="Apple-converted-space">  </span>tr.appendChild(c(`&lt;input type="email" placeholder="alex@example.com" value="${esc(p.email)}"&gt;`));</p>
<p class="p1"><span class="Apple-converted-space">  </span>tr.appendChild(c(`&lt;input type="text" placeholder="e.g. Couple A" value="${esc(p.group)}"&gt;`));</p>
<p class="p1"><span class="Apple-converted-space">  </span>tr.appendChild(c(`&lt;input type="text" placeholder="e.g. Jamie, Pat" value="${esc(p.exclude)}"&gt;`));</p>
<p class="p1"><span class="Apple-converted-space">  </span>const delBtn = document.createElement('button'); delBtn.textContent='✕'; delBtn.className='danger'; delBtn.onclick=()=&gt;tr.remove();</p>
<p class="p1"><span class="Apple-converted-space">  </span>const tdDel = document.createElement('td'); tdDel.appendChild(delBtn); tr.appendChild(tdDel);</p>
<p class="p1"><span class="Apple-converted-space">  </span>return tr;</p>
<p class="p1">}</p>
<p class="p1">function esc(s){ return String(s||'').replace(/&amp;/g,'&amp;amp;').replace(/&lt;/g,'&amp;lt;').replace(/"/g,'&amp;quot;'); }</p>
<p class="p1">function getPeople(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const rows = Array.from(tbody.querySelectorAll('tr'));</p>
<p class="p1"><span class="Apple-converted-space">  </span>const people = [];</p>
<p class="p1"><span class="Apple-converted-space">  </span>const seenNames = new Set(), seenEmails = new Set();</p>
<p class="p1"><span class="Apple-converted-space">  </span>for (const r of rows) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const [n,e,g,x] = r.querySelectorAll('input');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const name = n.value.trim(), email=e.value.trim(), group=g.value.trim(), excl=x.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!name &amp;&amp; !email) continue; // skip empty</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!name) throw new Error('Every person needs a name.');</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!email) throw new Error(`${name} is missing an email.`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const lname = name.toLowerCase(), lemail = email.toLowerCase();</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (seenNames.has(lname)) throw new Error(`Duplicate name: "${name}".`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (seenEmails.has(lemail)) throw new Error(`Duplicate email: "${email}".`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>seenNames.add(lname); seenEmails.add(lemail);</p>
<p class="p1"><span class="Apple-converted-space">    </span>people.push({name, email, group, exclude: excl});</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>if (people.length &lt; 2) throw new Error('Add at least 2 people.');</p>
<p class="p1"><span class="Apple-converted-space">  </span>return people;</p>
<p class="p1">}</p>
<p class="p1">function setStatus(msg, ok=true){ pill.textContent = msg; pill.className = 'pill ' + (ok?'ok':'err'); }</p>
<p class="p2"><br></p>
<p class="p1">document.getElementById('addRow').onclick = ()=&gt; tbody.appendChild(rowTemplate());</p>
<p class="p1">document.getElementById('sample').onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>tbody.innerHTML='';</p>
<p class="p1"><span class="Apple-converted-space">  </span>[</p>
<p class="p1"><span class="Apple-converted-space">    </span>{name:'Alex',email:'alex@example.com',group:'House A'},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{name:'Jamie',email:'jamie@example.com',group:'House A'},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{name:'Pat',email:'pat@example.com'},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{name:'Sam',email:'sam@example.com',exclude:'Pat'},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{name:'Riley',email:'riley@example.com',group:'House B'},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{name:'Taylor',email:'taylor@example.com',group:'House B'}</p>
<p class="p1"><span class="Apple-converted-space">  </span>].forEach(p=&gt;tbody.appendChild(rowTemplate(p)));</p>
<p class="p1"><span class="Apple-converted-space">  </span>setStatus('Sample loaded ✅');</p>
<p class="p1">};</p>
<p class="p1">document.getElementById('clear').onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>if (confirm('Clear all rows?')) { tbody.innerHTML=''; setStatus('Cleared.'); }</p>
<p class="p1">};</p>
<p class="p1">document.getElementById('save').onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const data = { people: getPeople(), org: document.getElementById('orgEmail').value.trim(), subj: document.getElementById('emailSubject').value.trim() };</p>
<p class="p1"><span class="Apple-converted-space">    </span>localStorage.setItem('ss_list_v2', JSON.stringify(data));</p>
<p class="p1"><span class="Apple-converted-space">    </span>setStatus('Saved to this browser ✅');</p>
<p class="p1"><span class="Apple-converted-space">  </span>} catch (e) { setStatus(e.message, false); }</p>
<p class="p1">};</p>
<p class="p1">document.getElementById('load').onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>const raw = localStorage.getItem('ss_list_v2');</p>
<p class="p1"><span class="Apple-converted-space">  </span>if (!raw) return setStatus('Nothing saved.', false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const data = JSON.parse(raw);</p>
<p class="p1"><span class="Apple-converted-space">  </span>tbody.innerHTML='';</p>
<p class="p1"><span class="Apple-converted-space">  </span>(data.people||[]).forEach(p=&gt;tbody.appendChild(rowTemplate(p)));</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById('orgEmail').value = data.org || '';</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById('emailSubject').value = data.subj || '';</p>
<p class="p1"><span class="Apple-converted-space">  </span>setStatus('Loaded saved list ✅');</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">document.getElementById('send').onclick = async ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const people = getPeople();</p>
<p class="p1"><span class="Apple-converted-space">    </span>const organizerEmail = document.getElementById('orgEmail').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">    </span>const subject = document.getElementById('emailSubject').value.trim() || 'Your Secret Santa assignment 🎁';</p>
<p class="p1"><span class="Apple-converted-space">    </span>const messageIntro = 'Keep it secret. Keep it safe. 🎅';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>setStatus('Sending… this can take a few seconds.');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const res = await fetch(GAS_ENDPOINT, {</p>
<p class="p1"><span class="Apple-converted-space">      </span>method:'POST',</p>
<p class="p1"><span class="Apple-converted-space">      </span>headers:{'Content-Type':'application/json'},</p>
<p class="p1"><span class="Apple-converted-space">      </span>body: JSON.stringify({ organizerEmail, subject, messageIntro, people })</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>const data = await res.json();</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!res.ok || !data.ok) throw new Error(data.error || 'Failed to send.');</p>
<p class="p1"><span class="Apple-converted-space">    </span>setStatus(`Done! Sent ${data.sent} email(s) ${data.failures &amp;&amp; data.failures.length? `(with ${data.failures.length} failure[s])`:''}. You will NOT see pairings.`);</p>
<p class="p1"><span class="Apple-converted-space">  </span>} catch (e) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>setStatus(e.message, false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// start with 3 rows</p>
<p class="p1">for (let i=0;i&lt;3;i++) tbody.appendChild(rowTemplate());</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
